<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>C&E – Personnalisation Poké XL</title>
<style>
  :root{
    --brand:#ff3a3a; --bg:#fff8f5; --ink:#333; --panel:#ffffff;
    --muted:#f4f4f4; --shadow:0 2px 10px rgba(0,0,0,.08);
  }
  *{box-sizing:border-box} body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--ink)}
  header{background:var(--brand);color:#fff;padding:1.6rem 1rem}
  header .wrap{max-width:1100px;margin:0 auto;display:flex;gap:1rem;align-items:center;justify-content:space-between}
  header a{color:#fff;text-decoration:none;font-weight:700}
  .wrap{max-width:1100px;margin:0 auto;padding:1rem}

  .section{margin:1rem 0;background:var(--panel);border-radius:16px;box-shadow:var(--shadow);padding:1rem}
  .section h2{margin:.2rem 0 1rem;color:var(--brand);font-size:1.4rem}
  .ingredients-grid{display:grid;gap:.8rem;grid-template-columns:repeat(auto-fit,minmax(140px,1fr))}
  .ingredients-grid label{
    display:flex;flex-direction:column;align-items:center;gap:.5rem;
    border:1px solid #eee;background:#fff;border-radius:14px;padding:.8rem;cursor:pointer;
    box-shadow:var(--shadow)
  }
  .ingredients-grid img{width:90px;height:90px;object-fit:contain}
  .counter{font-size:.95rem;color:#555;margin:.4rem 0}
  .muted{color:#666}
  .actions{display:flex;gap:.8rem;flex-wrap:wrap;justify-content:flex-end;margin-top:1rem}
  .btn{background:var(--brand);color:#fff;border:none;border-radius:12px;padding:.9rem 1.2rem;font-weight:700;cursor:pointer;box-shadow:var(--shadow)}
  .btn[disabled]{opacity:.5;cursor:not-allowed}
  .note{background:#fff3f3;border:1px solid #ffd2d2;color:#b60000;padding:.6rem .8rem;border-radius:10px;margin:.4rem 0}

/* Bouton flottant caddie + pastille */
.fab-cart{
  position:fixed;
  right:18px; left:auto;   /* force côté droit */
  bottom:18px; z-index:20;
  background:var(--brand); border:none; color:#fff;
  width:62px; height:62px; border-radius:50%;
  box-shadow:0 8px 24px rgba(255,58,58,.35);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; position:relative;
}
.fab-cart img{ width:30px; height:30px; filter:invert(1) brightness(9); }
.fab-cart:hover{ transform:translateY(-1px); }
.fab-cart .badge{
  position:absolute; top:6px; right:6px;
  background:#fff; color:var(--brand);
  font-weight:700; font-size:.8rem;
  border-radius:999px; padding:2px 6px;
  box-shadow:0 2px 6px rgba(0,0,0,.25);
}


</style>
</head>
<body>
<header>
  <div class="wrap">
    <div><a href="carte.html">← Retour à la carte</a></div>
    <strong>Compose ton Poké XL</strong>
    <a href="panier.html">Voir le panier</a>
  </div>
</header>

<main class="wrap">
  <!-- Base -->
  <div class="section">
    <h2>Base</h2>
    <div class="ingredients-grid">
      <label><input type="radio" name="base" value="riz" required><img src="images/riz.png"><span>Riz</span></label>
      <label><input type="radio" name="base" value="riz noir"><img src="images/riznoir.png"><span>Riz Noir</span></label>
      <label><input type="radio" name="base" value="duo riz"><img src="images/duoderiz.png"><span>Duo de Riz</span></label>
            <label><input type="radio" name="base" value="salade"><img src="images/salade.png"><span>Salade</span></label>
    </div>
  </div>

  <!-- Ingrédients -->
  <div class="section">
    <h2>Ingrédients (6 max)</h2>
    <div class="counter" id="ingCounter"></div>
    <div class="ingredients-grid" id="ingredients">
      <label><input type="checkbox" value="avocat"><img src="images/avocat.png"><span>Avocat</span></label>
      <label><input type="checkbox" value="betterave"><img src="images/betterave.png"><span>Betterave</span></label>
      <label><input type="checkbox" value="carotte"><img src="images/carotte.png"><span>Carotte</span></label>
      <label><input type="checkbox" value="champignon"><img src="images/champignon.png"><span>Champignon</span></label>
      <label><input type="checkbox" value="chouxrouge"><img src="images/chouxrouge.png"><span>Choux rouge</span></label>
      <label><input type="checkbox" value="concombre"><img src="images/concombre.png"><span>Concombre</span></label>
      <label><input type="checkbox" value="edamame"><img src="images/edamame.png"><span>Edamame</span></label>
      <label><input type="checkbox" value="feta"><img src="images/feta.png"><span>Feta</span></label>
      <label><input type="checkbox" value="grenade"><img src="images/grenade.png"><span>Grenade</span></label>
      <label><input type="checkbox" value="mais"><img src="images/mais.png"><span>Maïs</span></label>
      <label><input type="checkbox" value="mangue"><img src="images/mangue.png"><span>Mangue</span></label>
      <label><input type="checkbox" value="mozzarella"><img src="images/mozzarella.png"><span>Mozzarella</span></label>
      <label><input type="checkbox" value="oignonrouge"><img src="images/oignonrouge.png"><span>Oignon rouge</span></label>
      <label><input type="checkbox" value="poivrons"><img src="images/poivrons.png"><span>Poivrons</span></label>
      <label><input type="checkbox" value="radis"><img src="images/radis.png"><span>Radis</span></label>
      <label><input type="checkbox" value="tomates"><img src="images/tomates.png"><span>Tomates</span></label>
      <label><input type="checkbox" value="wakame"><img src="images/wakame.png"><span>Wakame</span></label>
    </div>
    <div class="note" id="ingHint" style="display:none"></div>
  </div>

  <!-- Protéines -->
  <div class="section">
    <h2>Protéines (2 max)</h2>
    <div class="counter" id="protCounter"></div>
    <div class="ingredients-grid" id="proteines">
      <label><input type="checkbox" value="saumon"><img src="images/saumon.png"><span>Saumon</span></label>
      <label><input type="checkbox" value="poulet"><img src="images/poulet.png"><span>Poulet</span></label>
      <label><input type="checkbox" value="oeufs"><img src="images/oeufs.png"><span>Œufs</span></label>
      <label><input type="checkbox" value="tofu"><img src="images/tofu.png"><span>Tofu</span></label>
      <label><input type="checkbox" value="thon"><img src="images/thon.png"><span>Thon</span></label>
    </div>
  </div>

  <!-- Sauce -->
  <div class="section">
    <h2>Sauce</h2>
    <div class="ingredients-grid" id="sauces">
      <label><input type="radio" name="sauce" value="soja sucrée" required><img src="images/soja.png"><span>Soja sucrée</span></label>
      <label><input type="radio" name="sauce" value="soja salée"><img src="images/soja.png"><span>Soja salée</span></label>
      <label><input type="radio" name="sauce" value="césar"><img src="images/césar.png"><span>César</span></label>
      <label><input type="radio" name="sauce" value="moutarde miel"><img src="images/miel_moutarde.png"><span>Moutarde miel</span></label>
      <label><input type="radio" name="sauce" value="curry mangue"><img src="images/curry_mango.png"><span>Curry mangue</span></label>
      <label><input type="radio" name="sauce" value="mayo épicée"><img src="images/mayo_epicee.png"><span>Mayo épicée</span></label>
      <label><input type="radio" name="sauce" value="passion"><img src="images/passion.png"><span>Passion</span></label>
      <label><input type="radio" name="sauce" value="balsamique"><img src="images/balsamique.png"><span>Balsamique</span></label>
    </div>
  </div>

  <!-- Toppings -->
  <div class="section">
    <h2>Toppings (optionnels)</h2>
    <div class="ingredients-grid" id="toppings">
      <label><input type="checkbox" value="sésame"><img src="images/sésame.png"><span>Sésame</span></label>
      <label><input type="checkbox" value="pavot"><img src="images/pavot.png"><span>Pavot</span></label>
      <label><input type="checkbox" value="cacahuete"><img src="images/cacahuètes.png"><span>Cacahuète</span></label>
      <label><input type="checkbox" value="croutons"><img src="images/croutons.png"><span>Croûtons</span></label>
      <label><input type="checkbox" value="coriandre"><img src="images/coriandre.png"><span>Coriandre</span></label>
      <label><input type="checkbox" value="oignons frits"><img src="images/oignons_frits.png"><span>Oignons frits</span></label>
    </div>
  </div>

  <!-- Action -->
  <div class="section actions">
    <button class="btn" id="addToCart" disabled>Ajouter au panier (14,5 €)</button>
  </div>
</main>

<button class="fab-cart" title="Voir le panier" onclick="window.location.href='panier.html'">
  <img src="images/caddie.png" alt="Panier">
  <div class="badge" id="cartBadge">0</div>
</button>


<script>
const CART_KEY = 'ce-panier';
if(!localStorage.getItem(CART_KEY)) localStorage.setItem(CART_KEY, JSON.stringify([]));

function validate(){
  const ingSel = document.querySelectorAll('#ingredients input:checked').length;
  const protSel = document.querySelectorAll('#proteines input:checked').length;
  const baseOk = !!document.querySelector('input[name="base"]:checked');
  const sauceOk = !!document.querySelector('input[name="sauce"]:checked');
  document.getElementById('ingCounter').textContent = `Ingrédients : ${ingSel}/6`;
  document.getElementById('protCounter').textContent = `Protéines : ${protSel}/2`;
  document.getElementById('addToCart').disabled = !(ingSel===6 && protSel===2 && baseOk && sauceOk);
}
document.querySelectorAll('input').forEach(el=>el.addEventListener('change', validate));

document.getElementById('addToCart').addEventListener('click', ()=>{
  const item = {
    type:'poke',
    size:'XL',
    base:document.querySelector('input[name="base"]:checked').value,
    ingredients:[...document.querySelectorAll('#ingredients input:checked')].map(x=>x.value),
    proteines:[...document.querySelectorAll('#proteines input:checked')].map(x=>x.value),
    sauce:document.querySelector('input[name="sauce"]:checked').value,
    toppings:[...document.querySelectorAll('#toppings input:checked')].map(x=>x.value),
    price:14.5,
    qty:1,
    ts:Date.now()
  };
  const cart = JSON.parse(localStorage.getItem(CART_KEY));
  cart.push(item);
  localStorage.setItem(CART_KEY, JSON.stringify(cart));
  alert("Poké XL ajouté !");
});
  const CART_KEY = 'ce-panier';
if(!localStorage.getItem(CART_KEY)) localStorage.setItem(CART_KEY, JSON.stringify([]));

function updateBadge(){
  const cart = JSON.parse(localStorage.getItem(CART_KEY) || '[]');
  document.getElementById('cartBadge').textContent = cart.length;
}

// mettre à jour dès le chargement
updateBadge();

// si tu veux que ça s’actualise aussi après chaque ajout au panier,
// appelle `updateBadge()` juste après avoir fait `localStorage.setItem(...)`

</script>
</body>
</html>
